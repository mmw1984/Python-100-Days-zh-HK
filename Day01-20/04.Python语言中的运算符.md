##  Python語言中嘅運算符

Python 語言支援好多種運算符，下面嘅表格按照運算符嘅優先級由高到低，列出咗 Python 中嘅運算符。有咗變數同運算符，我哋就可以構建各式各樣嘅表達式嚟解決實際問題。喺電腦科學中，**表達式係電腦程式中嘅句法實體，佢由一個或多個常量、變數、函數同運算符組合而成，程式語言可以對佢進行解釋同計算以得到另一個值**。唔明呢句都唔緊要，但係一定要知道，無論用咩程式語言，構建表達式都非常重要。

| 運算符                                                       | 描述                           |
| ------------------------------------------------------------ | ------------------------------ |
| `[]`、`[:]`                                                 | 索引、切片                  |
| `**`                                                         | 冪                             |
| `~`、`+`、`-`                                              | 位元反轉、正號、負號         |
| `*`、`/`、`%`、`//`                                       | 乘、除、模數、整除            |
| `+`、`-`                                                    | 加、減                        |
| `>>`、`<<`                                                  | 右移、左移                    |
| `&`                                                          | 位元與                         |
| `^`、`|`                                                   | 位元異或、位元或              |
| `<=`、`<`、`>`、`>=`                                      | 小於等於、小於、大於、大於等於 |
| `==`、`!=`                                                   | 等於、不等於                  |
| `is`、`is not`                                               | 身份運算符                     |
| `in`、`not in`                                                | 成員運算符                     |
| `not`、`or`、`and`                                             | 邏輯運算符                     |
| `=`、`+=`、`-=`、`*=`、`/=`、`%=`、`//=`、`**=`、`&=`、`\|=`、`^=`、`>>=`、`<<=` | 賦值運算符             |

>**說明**： 所謂優先級就係喺一個運算嘅表達式中，如果出現咗多個運算符，應該先執行咩再執行咩嘅順序。編寫代碼嘅時候，如果搞唔清楚一個表達式中運算符嘅優先級，可以用圓括號（小括號）嚟確保運算嘅執行順序。

### 算術運算符

Python 中嘅算術運算符非常豐富，除咗大家最熟悉嘅加、減、乘、除之外，仲有整除運算符、求模（求餘數）運算符同求冪運算符。下面嘅例子為大家展示咗算術運算符嘅使用。

```python
"""
算術運算符

Version: 1.0
Author: 駱昊
"""
print(321 + 12)     # 加法運算，輸出333
print(321 - 12)     # 減法運算，輸出309
print(321 * 12)     # 乘法運算，輸出3852
print(321 / 12)     # 除法運算，輸出26.75
print(321 // 12)    # 整除運算，輸出26
print(321 % 12)     # 求模數運算，輸出9
print(321 ** 12)    # 求冪運算，輸出1196906950228928915420617322241
```

算術運算需要先乘除後加減，呢一點同數學課本中講嘅知識冇分別，亦即係話乘除法嘅運算優先級係高於加減法嘅。如果仲有求冪運算，求冪運算嘅優先級係高於乘除法嘅。如果想改變算術運算嘅執行順序，可以用英文輸入法狀態下嘅圓括號（小括號），寫喺圓括號中嘅表達式會優先執行，如下面嘅例子所示。

```python
"""
算術運算嘅優先級

Version: 1.0
Author: 駱昊
"""
print(2 + 3 * 5)           # 17
print((2 + 3) * 5)         # 25
print((2 + 3) * 5 ** 2)    # 125
print(((2 + 3) * 5) ** 2)  # 625
```

### 賦值運算符

賦值運算符應該係最常見嘅運算符，佢嘅作用係將右邊嘅值賦畀左邊嘅變數。賦值運算符仲可以同上面嘅算術運算符放埋一齊，組合成複合賦值運算符，例如：`a += b`等同於`a = a + b`，`a *= a + 2`等同於`a = a * (a + 2)`。下面嘅例子演示咗賦值運算符同複合賦值運算符嘅使用。

```python
"""
賦值運算符同複合賦值運算符

Version: 1.0
Author: 駱昊
"""
a = 10
b = 3
a += b        # 等同於：a = a + b
a *= a + 2    # 等同於：a = a * (a + 2)
print(a)      # 大家計下呢度會輸出咩
```

賦值運算構成嘅表達式本身唔會產生任何值，亦即係話，如果你將一個賦值表達式放喺`print`函數中嘗試輸出表達式嘅值，將會產生語法錯誤。為咗解決呢個問題，Python 3.8 中引入咗一個新嘅賦值運算符`:=`，我哋叫做海象運算符，大家可以估下佢點解叫呢個名。海象運算符都係將運算符右側嘅值賦畀左邊嘅變數，同賦值運算符唔同嘅係，運算符右側嘅值都係成個表達式嘅值，睇下下面嘅代碼大家就明白啦。

```python
"""
海象運算符

Version: 1.0
Author: 駱昊
"""
# SyntaxError: invalid syntax
# print((a = 10))
# 海象運算符
print((a := 10))  # 10
print(a)          # 10
```

> **提示**：上面第 8 行代碼如果唔註釋掉，運行代碼會睇到`SyntaxError: invalid syntax`錯誤信息，注意，呢行代碼中我哋畀`a = 10`加咗圓括號，如果唔小心寫咗`print(a = 10)`，會睇到`TypeError: 'a' is an invalid keyword argument for print()`錯誤信息，後面講到函數嘅時候，大家就會明白呢個錯誤提示係咩意思啦。

### 比較運算符同邏輯運算符

比較運算符亦叫做關係運算符，包括`==`、`!=`、`<`、`>`、`<=`、`>=`，我相信大家一睇就明。需要提醒嘅係比較相等用嘅係`==`，請注意呢度係兩個等號，因為`=`係賦值運算符，我哋喺上面啱啱講過。比較不相等用嘅係`!=`，同數學課本中用嘅$\small{\neq}$並唔相同，Python 2 中曾經使用過`<>`嚟表示不等於，喺 Python 3 中使用`<>`會引發`SyntaxError`（語法錯誤）。比較運算符會產生布爾值，一係`True`，一係`False`。

邏輯運算符有三個，分別係`and`、`or`同`not`。`and`字面意思係「而且」，所以`and`運算符會連接兩個布爾值或者產生布爾值嘅表達式，如果兩邊嘅布爾值都係`True`，咁運算嘅結果就係`True`；左右兩邊嘅布爾值有一個係`False`，最終嘅運算結果就係`False`。當然，如果`and`運算符左邊嘅布爾值係`False`，無論右邊嘅布爾值係咩，最終嘅結果都係`False`，呢個時候運算符右邊嘅布爾值會被跳過（專業嘅講法叫做短路處理，如果`and`右邊係一個表達式，咁呢個表達式就唔會執行）。`or`字面意思係「或者」，所以`or`運算符都會連接兩個布爾值或產生布爾值嘅表達式，如果兩邊嘅布爾值有任意一個係`True`，咁最終嘅結果就係`True`。當然，`or`運算符都係有短路功能嘅，當佢左邊嘅布爾值係`True`嘅情況下，右邊嘅布爾值會被短路（如果`or`右邊係一個表達式，咁呢個表達式就唔會執行）。`not`運算符嘅後面可以跟一個布爾值，如果`not`後面嘅布爾值或表達式係`True`，咁運算嘅結果就係`False`；如果`not`後面嘅布爾值或表達式係`False`，咁運算嘅結果就係`True`。

```python
"""
比較運算符同邏輯運算符嘅使用

Version: 1.0
Author: 駱昊
"""
flag0 = 1 == 1
flag1 = 3 > 2
flag2 = 2 < 1
flag3 = flag1 and flag2
flag4 = flag1 or flag2
flag5 = not flag0
print('flag0 =', flag0)     # flag0 = True
print('flag1 =', flag1)     # flag1 = True
print('flag2 =', flag2)     # flag2 = False
print('flag3 =', flag3)     # flag3 = False
print('flag4 =', flag4)     # flag4 = True
print('flag5 =', flag5)     # flag5 = False
print(flag1 and not flag2)  # True
print(1 > 2 or 2 == 3)      # False
```

> **說明**：比較運算符嘅優先級高於賦值運算符，所以上面嘅`flag0 = 1 == 1`先做`1 == 1`產生布爾值`True`，再將呢個值賦畀變數`flag0`。`print`函數可以輸出多個值，多個值之間可以用`,`分隔，輸出嘅內容默認以空格分開。

### 運算符同表達式應用

#### 例子1：華氏溫度轉攝氏溫度

> **要求**：輸入華氏溫度將佢轉換為攝氏溫度，華氏溫度到攝氏溫度嘅轉換公式為： $\small{C = (F - 32) / 1.8}$ 。

```python
"""
將華氏溫度轉換為攝氏溫度

Version: 1.0
Author: 駱昊
"""
f = float(input('請輸入華氏溫度: '))
c = (f - 32) / 1.8
print('%.1f華氏度 = %.1f攝氏度' % (f, c))
```

> **說明**：上面代碼中嘅`input`函數用於從鍵盤接收用戶輸入，因為輸入嘅都係字符串，如果想處理成浮點小數嚟做後續嘅運算，可以用我哋上一課講解嘅類型轉換嘅方法，用`float`函數將`str`類型處理成`float`類型。

上面嘅代碼中，我哋對`print`函數輸出嘅內容進行咗格式化處理，`print`輸出嘅字符串中有兩個`%.1f`占位符，呢兩個占位符會被`%`之後嘅`(f, c)`中嘅兩個`float`類型嘅變數值畀替換掉，浮點數小數點後保留1位有效數字。如果字符串中有`%d`占位符，咁我哋會用`int`類型嘅值替換掉佢，如果字符串中有`%s`占位符，咁佢會被`str`類型嘅值替換掉。

除咗上面格式化輸出嘅方式之外，Python 中仲可以用下面嘅辦法嚟格式化輸出，我哋畀出一個帶占位符嘅字符串，字符串前面嘅`f`表示呢個字符串係需要格式化處理嘅，其中嘅`{f:.1f}`同`{c:.1f}`可以先睇成係`{f}`同`{c}`，表示輸出時會用變數`f`同變數`c`嘅值替換掉呢兩個占位符，後面嘅`:.1f`表示呢個係一個浮點數，小數點後保留1位有效數字。

```python
"""
將華氏溫度轉換為攝氏溫度

Version: 1.1
Author: 駱昊
"""
import math

f = float(input('請輸入華氏溫度: '))
c = (f - 32) / 1.8
print(f'{f:.1f}華氏度 = {c:.1f}攝氏度')
```

#### 例子2：計算圓嘅周長同面積

> **要求**：輸入一個圓嘅半徑（$\small{r}$），計算出佢嘅周長（ $\small{2 \pi r}$ ）同面積（ $\small{\pi r^{2}}$ ）。

```python
"""
輸入半徑計算圓嘅周長同面積

Version: 1.0
Author: 駱昊
"""
radius = float(input('請輸入圓嘅半徑: '))
perimeter = 2 * 3.1416 * radius
area = 3.1416 * radius * radius
print('周長: %.2f' % perimeter)
print('面積: %.2f' % area)
```

Python 中有一個叫做`math` 嘅內置模組，呢個模組中定義咗叫做`pi`嘅變數，佢嘅值就係圓周率。如果想使用 Python 內置嘅呢個`pi`，我哋可以對上面嘅代碼稍作修改。

```python
"""
輸入半徑計算圓嘅周長同面積

Version: 1.1
Author: 駱昊
"""
import math

radius = float(input('請輸入圓嘅半徑: '))
perimeter = 2 * math.pi * radius
area = math.pi * radius ** 2
print(f'周長: {perimeter:.2f}')
print(f'面積: {area:.2f}')
```

> **說明**：上面代碼中嘅`import math`表示導入`math`模組，導入呢個模組之後，先可以用`math.pi`得到圓周率嘅值。

呢度其實仲有一種格式化輸出嘅方式，係 Python 3.8 中新增嘅特性，大家直接睇下面嘅代碼就明白啦。

```python
"""
輸入半徑計算圓嘅周長同面積

Version: 1.2
Author: 駱昊
"""
import math

radius = float(input('請輸入圓嘅半徑: '))  # 輸入: 5.5
perimeter = 2 * math.pi * radius
area = math.pi * radius ** 2
print(f'{perimeter = :.2f}')  # 輸出：perimeter = 34.56
print(f'{area = :.2f}')       # 輸出：area = 95.03
```

> **說明**：假如變數`a`嘅值係`9.87`，咁字符串`f'{a = }'`嘅值係`a = 9.87`；而字符串`f'{a = :.1f}'`嘅值係`a = 9.9`。呢種格式化輸出嘅方式會同時輸出變數名同變數值。

#### 例子3：判斷閏年

要求：輸入一個 1582 年之後嘅年份，判斷該年份係咪閏年。

```python
"""
輸入年份，閏年輸出True，平年輸出False

Version: 1.0
Author: 駱昊
"""
year = int(input('請輸入年份: '))
is_leap = year % 4 == 0 and year % 100 != 0 or year % 400 == 0
print(f'{is_leap = }')
```

> **說明**：對於格里歷（Gregorian calendar），即今日我哋用嘅公曆，判斷閏年嘅規則係：1. 公元年份唔係 4 嘅倍數係平年；2. 公元年份係 4 嘅倍數但唔係 100 嘅倍數係閏年；3. 公元年份係 400 嘅倍數係閏年。格里歷係由教皇格里高利十三世喺 1582 年 10 月引入嘅，作為對儒略歷（Julian calendar）嘅修改同替代，我哋喺輸入年份時要注意呢一點。上面嘅代碼通過`%`嚟判斷`year`係咪`4`嘅倍數、`100`嘅倍數、`400`嘅倍數，然後用`and`同`or`運算符將三個條件組合埋一齊，頭兩個條件要同時滿足，第三個條件同頭兩個條件嘅組合只需要滿足其中之一。

### 總結

通過上面嘅講解同例子，相信大家已經感受到運算符同表達式嘅力量。實際程式編寫中嘅好多問題，都需要通過構建表達式嚟解決，所以變數、運算符、表達式對於任何一門程式語言都係非常重要嘅基礎。如果本節課嘅內容有咩唔理解嘅地方，一定唔好心急進入下一課，先喺評論區留言討論，我會及時解答大家嘅問題。
