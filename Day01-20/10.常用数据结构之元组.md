## 常用數據結構之元組

前面嘅兩節課，我哋為大家講解咗 Python 中嘅列表，佢係一種容器型嘅數據類型，透過列表類型嘅變數，我哋可以保存多個數據並透過循環實現對數據嘅批量操作。當然，Python 中仲有其他容器型嘅數據類型，接下來我哋就為大家講解另一種容器型嘅數據類型，佢嘅名字叫元組（tuple）。

### 元組嘅定義同運算

喺 Python 語言中，元組都係多個元素按照一定順序構成嘅序列。元組同列表嘅唔同之處喺於，**元組係不可變類型**，呢個就意味住元組類型嘅變數一旦定義，其中嘅元素唔可以再添加或刪除，而且元素嘅值都唔可以修改。如果試圖修改元組中嘅元素，將引發`TypeError`錯誤，導致程式崩潰。定義元組通常使用形如`(x, y, z)`嘅字面量語法，元組類型支持嘅運算符同列表係一樣嘅，我哋可以睇下下面嘅代碼。

```python
# 定義一個三元組
t1 = (35, 12, 98)
# 定義一個四元組
t2 = ('駱昊', 45, True, '四川成都')

# 查看變數嘅類型
print(type(t1))  # <class 'tuple'>
print(type(t2))  # <class 'tuple'>

# 查看元組中元素嘅數量
print(len(t1))  # 3
print(len(t2))  # 4

# 索引運算
print(t1[0])    # 35
print(t1[2])    # 98
print(t2[-1])   # 四川成都

# 切片運算
print(t2[:2])   # ('駱昊', 43)
print(t2[::3])  # ('駱昊', '四川成都')

# 循環遍歷元組中嘅元素
for elem in t1:
    print(elem)

# 成員運算
print(12 in t1)         # True
print(99 in t1)         # False
print('Hao' not in t2)  # True

# 拼接運算
t3 = t1 + t2
print(t3)  # (35, 12, 98, '駱昊', 43, True, '四川成都')

# 比較運算
print(t1 == t3)            # False
print(t1 >= t3)            # False
print(t1 <= (35, 11, 99))  # False
```

一個元組中如果有兩個元素，我哋就稱之為二元組；一個元組中如果五個元素，我哋就稱之為五元組。需要提醒大家注意嘅係，`()`表示空元組，但係如果元組中只有一個元素，需要加上一個逗號，否則`()`就唔係代表元組嘅字面量語法，而係改變運算優先級嘅圓括號，所以`('hello', )`同`(100, )`先係一元組，而`('hello')`同`(100)`只係字符串同整數。我哋可以透過下面嘅代碼嚟加以驗證。

```python
a = ()
print(type(a))  # <class 'tuple'>
b = ('hello')
print(type(b))  # <class 'str'>
c = (100)
print(type(c))  # <class 'int'>
d = ('hello', )
print(type(d))  # <class 'tuple'>
e = (100, )
print(type(e))  # <class 'tuple'>
```

### 打包同解包操作

當我哋將多個用逗號分隔嘅值賦畀一個變數時，多個值會打包成一個元組類型；當我哋將一個元組賦值畀多個變數時，元組會解包成多個值然後分別賦畀對應嘅變數，如下面嘅代碼所示。

```python
# 打包操作
a = 1, 10, 100
print(type(a))  # <class 'tuple'>
print(a)        # (1, 10, 100)
# 解包操作
i, j, k = a
print(i, j, k)  # 1 10 100
```

喺解包時，如果解包出來嘅元素個數同變數個數唔對應，會引發`ValueError`異常，錯誤信息為：`too many values to unpack`（解包嘅值太多）或`not enough values to unpack`（解包嘅值不足）。

```python
a = 1, 10, 100, 1000
# i, j, k = a             # ValueError: too many values to unpack (expected 3)
# i, j, k, l, m, n = a    # ValueError: not enough values to unpack (expected 6, got 4)
```

有一種解決變數個數少於元素個數嘅方法，就係使用星號表達式。透過星號表達式，我哋可以令一個變數接收多個值，代碼如下所示。需要注意兩點：首先，用星號表達式修飾嘅變數會變成一個列表，列表中有0個或多個元素；其次，喺解包語法中，星號表達式只能出現一次。

```python
a = 1, 10, 100, 1000
i, j, *k = a
print(i, j, k)        # 1 10 [100, 1000]
i, *j, k = a
print(i, j, k)        # 1 [10, 100] 1000
*i, j, k = a
print(i, j, k)        # [1, 10] 100 1000
*i, j = a
print(i, j)           # [1, 10, 100] 1000
i, *j = a
print(i, j)           # 1 [10, 100, 1000]
i, j, k, *l = a
print(i, j, k, l)     # 1 10 100 [1000]
i, j, k, l, *m = a
print(i, j, k, l, m)  # 1 10 100 1000 []
```

需要說明一點，解包語法對所有嘅序列都成立，呢個就意味住我哋之前講嘅列表、`range`函數構建嘅範圍序列甚至字符串都可以使用解包語法。大家可以嘗試運行下面嘅代碼，睇下會出現點樣嘅結果。

```python
a, b, *c = range(1, 10)
print(a, b, c)
a, b, c = [1, 10, 100]
print(a, b, c)
a, *b, c = 'hello'
print(a, b, c)
```

### 交換變數嘅值

交換變數嘅值係寫代碼時經常會用到嘅一個操作，但係喺好多程式語言中，交換兩個變數嘅值都需要借助一個中間變數先可以做到，如果唔用中間變數就需要使用比較晦澀嘅位運算嚟實現。喺 Python 中，交換兩個變數`a`同`b`嘅值只需要使用如下所示嘅代碼。

```python
a, b = b, a
```

同理，如果想將三個變數`a`、`b`、`c`嘅值互換，即`b`嘅值賦畀`a`，`c`嘅值賦畀`b`，`a`嘅值賦畀`c`，都可以如法炮製。

```python
a, b, c = b, c, a
```

需要說明嘅係，上面嘅操作並冇用到打包同解包語法，Python 嘅字節碼指令中有`ROT_TWO`同`ROT_THREE`咁樣嘅指令可以直接實現呢個操作，效率係非常高嘅。但係如果有多於三個變數嘅值要依次互換，呢個時候係冇直接可用嘅字節碼指令嘅，需要透過打包解包嘅方式嚟完成變數之間值嘅交換。

### 元組同列表嘅比較

呢度仲有一個非常值得探討嘅問題，Python 中已經有咗列表類型，點解仲需要元組咁樣嘅類型呢？呢個問題對於初學者嚟講似乎有啲困難，不過冇關係，我哋先拋出觀點，大家可以一邊學習一邊慢慢體會。

1. 元組係不可變類型，**不可變類型更適合多線程環境**，因為佢降低咗並發訪問變數嘅同步化開銷。關於呢一點，我哋會喺後面講解並發編程嘅時候同大家一齊探討。

2. 元組係不可變類型，通常**不可變類型喺創建時間上優於對應嘅可變類型**。我哋可以用`timeit`模組嘅`timeit`函數嚟睇下創建保存相同元素嘅元組同列表各自花費嘅時間，`timeit`函數嘅`number`參數表示代碼執行嘅次數。下面嘅代碼中，我哋分別創建咗保存`1`到`9`嘅整數嘅列表同元組，每個操作執行`10000000`次，統計運行時間。

   ```python
   import timeit
   
   print('%.3f 秒' % timeit.timeit('[1, 2, 3, 4, 5, 6, 7, 8, 9]', number=10000000))
   print('%.3f 秒' % timeit.timeit('(1, 2, 3, 4, 5, 6, 7, 8, 9)', number=10000000))
   ```

   輸出：

   ```
   0.635 秒
   0.078 秒
   ```

   > **說明**：上面代碼嘅執行結果因軟硬件系統而異，喺我目前使用嘅電腦上，執行`10000000`次創建列表嘅操作時間係`0.635`秒，而執行`10000000`次創建元組嘅操作時間係`0.078`秒，顯然創建元組更快且二者時間上有數量級嘅差別。大家可以喺自己嘅電腦上執行呢段代碼，將你嘅執行結果放喺評論區，睇下邊個嘅電腦更勁。

當然，Python 中嘅元組同列表類型係可以相互轉換嘅，我哋可以透過下面嘅代碼嚟完成該操作。

```python
infos = ('駱昊', 43, True, '四川成都')
# 將元組轉換成列表
print(list(infos))  # ['駱昊', 43, True, '四川成都']

frts = ['apple', 'banana', 'orange']
# 將列表轉換成元組
print(tuple(frts))  # ('apple', 'banana', 'orange')
```

### 總結

**列表同元組都係容器型嘅數據類型**，即一個變數可以保存多個數據，而且佢哋都係按一定順序組織元素嘅有序容器。**列表係可變數據類型**，**元組係不可變數據類型**，所以列表可以添加元素、刪除元素、清空元素、排序反轉，但呢啲操作對元組嚟講係唔成立嘅。列表同元組都可以支持**拼接運算**、**成員運算**、**索引運算**、**切片運算**等操作，後面我哋要講到嘅字符串類型都支持呢啲運算，因為字符串就係字符按一定順序構成嘅序列，喺呢一點上三者並冇咩區別。我哋**推薦大家使用列表嘅生成式語法嚟創建列表**，佢唔單止好用而且效率好高，係 Python 語言中非常有特色嘅語法。
